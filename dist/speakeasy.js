(()=>{"use strict";var e={268:(e,t)=>{var charmap=function(e,t){t||(t={});e.split("").forEach((function(e,r){if(!(e in t))t[e]=r}));return t};var r={alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",charmap:{0:14,1:8}};r.charmap=charmap(r.alphabet,r.charmap);var a={alphabet:"0123456789ABCDEFGHJKMNPQRSTVWXYZ",charmap:{O:0,I:1,L:1}};a.charmap=charmap(a.alphabet,a.charmap);function Decoder(e){this.buf=[];this.shift=8;this.carry=0;if(e){switch(e.type){case"rfc4648":this.charmap=t.rfc4648.charmap;break;case"crockford":this.charmap=t.crockford.charmap;break;default:throw new Error("invalid type")}if(e.charmap)this.charmap=e.charmap}}Decoder.prototype.charmap=r.charmap;Decoder.prototype.write=function(e){var t=this.charmap;var r=this.buf;var a=this.shift;var i=this.carry;e.toUpperCase().split("").forEach((function(e){if(e=="=")return;var o=t[e]&255;a-=5;if(a>0){i|=o<<a}else if(a<0){r.push(i|o>>-a);a+=8;i=o<<a&255}else{r.push(i|o);a=8;i=0}}));this.shift=a;this.carry=i;return this};Decoder.prototype.finalize=function(e){if(e){this.write(e)}if(this.shift!==8&&this.carry!==0){this.buf.push(this.carry);this.shift=8;this.carry=0}return this.buf};function Encoder(e){this.buf="";this.shift=3;this.carry=0;if(e){switch(e.type){case"rfc4648":this.alphabet=t.rfc4648.alphabet;break;case"crockford":this.alphabet=t.crockford.alphabet;break;default:throw new Error("invalid type")}if(e.alphabet)this.alphabet=e.alphabet;else if(e.lc)this.alphabet=this.alphabet.toLowerCase()}}Encoder.prototype.alphabet=r.alphabet;Encoder.prototype.write=function(e){var t=this.shift;var r=this.carry;var a;var i;var o;for(o=0;o<e.length;o++){i=e[o];a=r|i>>t;this.buf+=this.alphabet[a&31];if(t>5){t-=5;a=i>>t;this.buf+=this.alphabet[a&31]}t=5-t;r=i<<t;t=8-t}this.shift=t;this.carry=r;return this};Encoder.prototype.finalize=function(e){if(e){this.write(e)}if(this.shift!==3){this.buf+=this.alphabet[this.carry&31];this.shift=3;this.carry=0}return this.buf};t.encode=function(e,t){return new Encoder(t).finalize(e)};t.decode=function(e,t){return new Decoder(t).finalize(e)};t.Decoder=Decoder;t.Encoder=Encoder;t.charmap=charmap;t.crockford=a;t.rfc4648=r},202:(e,t,r)=>{var a=r(268);var i=a.Decoder.prototype.finalize;a.Decoder.prototype.finalize=function(e){var t=i.call(this,e);return new Buffer(t)};e.exports=a},855:(e,t,r)=>{var a=r(202);var i=r(982);var o=r(16);var n=r(23);t.digest=function digest(e){var t;var r=e.secret;var o=e.counter;var n=e.encoding||"ascii";var c=(e.algorithm||"sha1").toLowerCase();if(e.key!=null){console.warn("Speakeasy - Deprecation Notice - Specifying the secret using `key` is no longer supported. Use `secret` instead.");r=e.key}if(!Buffer.isBuffer(r)){r=n==="base32"?a.decode(r):new Buffer(r,n)}var s=new Buffer(8);var h=o;for(t=0;t<8;t++){s[7-t]=h&255;h=h>>8}var p=i.createHmac(c,r);p.update(s);return p.digest()};t.hotp=function hotpGenerate(e){var r=(e.digits!=null?e.digits:e.length)||6;if(e.length!=null)console.warn("Speakeasy - Deprecation Notice - Specifying token digits using `length` is no longer supported. Use `digits` instead.");var a=e.digest||t.digest(e);var i=a[a.length-1]&15;var o=(a[i]&127)<<24|(a[i+1]&255)<<16|(a[i+2]&255)<<8|a[i+3]&255;o=new Array(r+1).join("0")+o.toString(10);return o.substr(-r)};t.counter=t.hotp;t.hotp.verifyDelta=function hotpVerifyDelta(e){var r;e=Object.create(e);var a=String(e.token);var i=parseInt(e.digits,10)||6;var o=parseInt(e.window,10)||0;var n=parseInt(e.counter,10)||0;if(a.length!==i){return}a=parseInt(a,10);if(isNaN(a)){return}for(r=n;r<=n+o;++r){e.counter=r;if(parseInt(t.hotp(e),10)===a){return{delta:r-n}}}};t.hotp.verify=function hotpVerify(e){return t.hotp.verifyDelta(e)!=null};t._counter=function _counter(e){var t=e.step||30;var r=e.time!=null?e.time*1e3:Date.now();var a=(e.epoch!=null?e.epoch*1e3:e.initial_time*1e3)||0;if(e.initial_time!=null)console.warn("Speakeasy - Deprecation Notice - Specifying the epoch using `initial_time` is no longer supported. Use `epoch` instead.");return Math.floor((r-a)/t/1e3)};t.totp=function totpGenerate(e){e=Object.create(e);if(e.counter==null)e.counter=t._counter(e);return this.hotp(e)};t.time=t.totp;t.totp.verifyDelta=function totpVerifyDelta(e){e=Object.create(e);var r=parseInt(e.window,10)||0;if(e.counter==null)e.counter=t._counter(e);e.counter-=r;e.window+=r;var a=t.hotp.verifyDelta(e);if(a){a.delta-=r}return a};t.totp.verify=function totpVerify(e){return t.totp.verifyDelta(e)!=null};t.generateSecret=function generateSecret(e){if(!e)e={};var r=e.length||32;var i=encodeURIComponent(e.name||"SecretKey");var o=e.qr_codes||false;var n=e.google_auth_qr||false;var c=e.otpauth_url!=null?e.otpauth_url:true;var s=true;if(e.symbols!==undefined&&e.symbols===false){s=false}var h=this.generateSecretASCII(r,s);var p={};p.ascii=h;p.hex=Buffer(h,"ascii").toString("hex");p.base32=a.encode(Buffer(h)).toString().replace(/=/g,"");if(o){console.warn("Speakeasy - Deprecation Notice - generateSecret() QR codes are deprecated and no longer supported. Please use your own QR code implementation.");p.qr_code_ascii="https://chart.googleapis.com/chart?chs=166x166&chld=L|0&cht=qr&chl="+encodeURIComponent(p.ascii);p.qr_code_hex="https://chart.googleapis.com/chart?chs=166x166&chld=L|0&cht=qr&chl="+encodeURIComponent(p.hex);p.qr_code_base32="https://chart.googleapis.com/chart?chs=166x166&chld=L|0&cht=qr&chl="+encodeURIComponent(p.base32)}if(c){p.otpauth_url=t.otpauthURL({secret:p.ascii,label:i})}if(n){console.warn("Speakeasy - Deprecation Notice - generateSecret() Google Auth QR code is deprecated and no longer supported. Please use your own QR code implementation.");p.google_auth_qr="https://chart.googleapis.com/chart?chs=166x166&chld=L|0&cht=qr&chl="+encodeURIComponent(t.otpauthURL({secret:p.base32,label:i}))}return p};t.generate_key=n.deprecate((function(e){return t.generateSecret(e)}),"Speakeasy - Deprecation Notice - `generate_key()` is depreciated, please use `generateSecret()` instead.");t.generateSecretASCII=function generateSecretASCII(e,t){var r=i.randomBytes(e||32);var a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz";if(t){a+="!@#$%^&*()<>?/[]{},.:;"}var o="";for(var n=0,c=r.length;n<c;n++){o+=a[Math.floor(r[n]/255*(a.length-1))]}return o};t.generate_key_ascii=n.deprecate((function(e,r){return t.generateSecretASCII(e,r)}),"Speakeasy - Deprecation Notice - `generate_key_ascii()` is depreciated, please use `generateSecretASCII()` instead.");t.otpauthURL=function otpauthURL(e){var t=e.secret;var r=e.label;var i=e.issuer;var n=(e.type||"totp").toLowerCase();var c=e.counter;var s=e.algorithm;var h=e.digits;var p=e.period;var u=e.encoding||"ascii";switch(n){case"totp":case"hotp":break;default:throw new Error("Speakeasy - otpauthURL - Invalid type `"+n+"`; must be `hotp` or `totp`")}if(!t)throw new Error("Speakeasy - otpauthURL - Missing secret");if(!r)throw new Error("Speakeasy - otpauthURL - Missing label");if(n==="hotp"&&(c===null||typeof c==="undefined")){throw new Error("Speakeasy - otpauthURL - Missing counter value for HOTP")}if(u!=="base32")t=new Buffer(t,u);if(Buffer.isBuffer(t))t=a.encode(t);var l={secret:t};if(i)l.issuer=i;if(s!=null){switch(s.toUpperCase()){case"SHA1":case"SHA256":case"SHA512":break;default:console.warn("Speakeasy - otpauthURL - Warning - Algorithm generally should be SHA1, SHA256, or SHA512")}l.algorithm=s.toUpperCase()}if(h!=null){if(isNaN(h)){throw new Error("Speakeasy - otpauthURL - Invalid digits `"+h+"`")}else{switch(parseInt(h,10)){case 6:case 8:break;default:console.warn("Speakeasy - otpauthURL - Warning - Digits generally should be either 6 or 8")}}l.digits=h}if(p!=null){p=parseInt(p,10);if(~~p!==p){throw new Error("Speakeasy - otpauthURL - Invalid period `"+p+"`")}l.period=p}return o.format({protocol:"otpauth",slashes:true,hostname:n,pathname:r,query:l})}},982:e=>{e.exports=require("crypto")},16:e=>{e.exports=require("url")},23:e=>{e.exports=require("util")}};var t={};function __nccwpck_require__(r){var a=t[r];if(a!==undefined){return a.exports}var i=t[r]={exports:{}};var o=true;try{e[r](i,i.exports,__nccwpck_require__);o=false}finally{if(o)delete t[r]}return i.exports}if(typeof __nccwpck_require__!=="undefined")__nccwpck_require__.ab=__dirname+"/";var r=__nccwpck_require__(855);module.exports=r})();